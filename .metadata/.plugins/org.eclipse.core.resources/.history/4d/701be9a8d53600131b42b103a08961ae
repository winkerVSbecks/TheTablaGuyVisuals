import processing.core.PApplet;

import java.util.ArrayList;

public class RainScene {

	PApplet p;
	String name;
	int track;
	int rainNum = 100;
	ArrayList<Rain> drops = new ArrayList<Rain>();
	ArrayList<Splash> splashes = new ArrayList<Splash>();
	float reseed;

	public RainScene(PApplet _p, String _name, int _track) {
		p = _p;
		name = _name;
		track = _track;
		reseed = p.random(0.2f);
		drops.add( new Rain(p) );
	}

	public void draw() {
		// Gives the drops a little tail
		p.fill(0, 50);
		p.rect(0, 0, p.width, p.height);

		if(p.frameCount % 240 == 0 && drops.size() < 150) {
			drops.add( new Rain(p) );
			float reseed = p.random(0.2f);
		}

		for(Rain drop : drops) {
			drop.calculate();
			drop.draw();
			if(drop.position.y > p.height) {		      
				for(int k = 0 ; k < p. random(5, 10) ; k++) {
					splashes.add( new Splash(p, drop.position.x, p.height) );
				}
				drops.remove(drop);
				float rand = p.random(0, 100);
				if (rand > 10 && drops.size() < 150)
					drops.add( new Rain(p) );
			}
		}

		for(Splash splash : splashes) {
		
		for (int i=0 ; i<splashes.size() ; i++) {
			Splash spl = (Splash) splash.get(i);
			spl.calculate();
			spl.draw();
			if (spl.position.y>height)
				splash.remove(i);
		}
	}
}
