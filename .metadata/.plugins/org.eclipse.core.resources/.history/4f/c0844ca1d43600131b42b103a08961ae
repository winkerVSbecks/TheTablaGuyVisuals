import processing.core.PApplet;
import java.util.ArrayList;

public class RainScene {
	
	PApplet p;
	String name;
	int track;
	int rainNum = 100;
	ArrayList<Rain> rain = new ArrayList<Rain>();
	ArrayList<Splash> splash = new ArrayList<Splash>();
	float reseed;

	public RainScene(PApplet _p, String _name, int _track) {
		p = _p;
		name = _name;
		track = _track;
		reseed = p.random(0.2f);
		rain.add( new Rain(p) );
	}
	
	public void draw() {
		// Gives the drops a little tail
		p.fill(0, 50);
		p.rect(0, 0, p.width, p.height);
		
		if (p.frameCount % 240 == 0 && rain.size() < 150) {
		    rain.add( new Rain(p) );
		    float reseed = p.random(0.2f);
		  }
		  
		  for (int i=0 ; i<rain.size() ; i++)
		  {
		    Rain rainT = (Rain) rain.get(i);
		    rainT.calculate();
		    rainT.draw();
		    if (rainT.position.y>height)
		    {
		      
		      for (int k = 0 ; k<random(5,10) ; k++)
		      {
		        splash.add(new Splash(rainT.position.x,height));
		      }
		      
		      rain.remove(i);
		      float rand = random(0,100);
		      if (rand>10&&rain.size()<150)
		      rain.add(new Rain());
		    }
		  }
		  
		  for (int i=0 ; i<splash.size() ; i++)
		  {
		    Splash spl = (Splash) splash.get(i);
		    spl.calculate();
		    spl.draw();
		    if (spl.position.y>height)
		    splash.remove(i);
		  }
	}
}
